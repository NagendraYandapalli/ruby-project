version: v2
global:
  runner:
    os_image: ubuntu

tasks:
  build-image:
    steps:
    - checkout
    - docker/build:
        image: ghcr.io/razorops-public/rails-sample-app/rails-app
        push: true
        tags: ["latest", "${CI_COMMIT_SHA:0:8}"]
        dockerfile: Dockerfile
        context: .
tasks:
  hello-job:
    runner: sonarsource/sonar-scanner-cli
    steps:
   
    - checkout    
    - commands:
      - |
      sonar-scanner \
       -Dsonar.projectKey=ruby \
       -Dsonar.sources=. \
       -Dsonar.host.url=http://13.233.126.85:9000 \
       -Dsonar.login=0a6d4c4d4704991b4efebdb329dcedf2c7e75151        
